# Инструкция по применению миграции для добавления поля watchUrl

## Что было сделано:

1. ✅ Добавлено поле `watchUrl` в тип `MediaItem` (`lib/types.ts`)
2. ✅ Добавлено поле `watchUrl` в Prisma схему (`prisma/schema.prisma`)
3. ✅ Обновлены функции работы с базой данных (`lib/db.ts`)
4. ✅ Обновлены данные в mock файле (`lib/db-mock.ts`)

## Как применить изменения к базе данных:

### Вариант 1: Использовать Prisma Migrate (рекомендуется)

```bash
# Создать и применить миграцию
npm run db:migrate -- --name add_watch_url

# Или использовать db:push для быстрого обновления схемы без миграции
npm run db:push
```

### Вариант 2: Применить SQL миграцию вручную

Если вы используете прямые SQL запросы, выполните:

```sql
ALTER TABLE media_items ADD COLUMN IF NOT EXISTS watch_url VARCHAR(500);
```

### Вариант 3: Использовать Prisma Studio для проверки

```bash
npm run db:studio
```

## После применения миграции:

1. Сгенерируйте Prisma Client:
```bash
npm run db:generate
```

2. Перезапустите сервер разработки:
```bash
npm run dev
```

## Проверка:

После применения миграции проверьте, что:
- ✅ Поле `watch_url` появилось в таблице `media_items`
- ✅ API возвращает поле `watchUrl` в ответах
- ✅ Компонент `media-detail.tsx` корректно отображает ссылки

## Примечание:

Все ссылки уже добавлены в mock данные (`lib/db-mock.ts`), поэтому при использовании fallback механизма они будут работать даже без базы данных.

